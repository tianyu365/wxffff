<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="renderer" content="webkit">
    <meta name="layoutmode" content="standard">
    <meta name="imagemode" content="force">
    <meta name="wap-font-scale" content="no">
    <meta name="format-detection" content="telephone=no">
    <title>ç½‘é¡µåµŒå…¥å™¨</title>
    
    <meta property="og:type" content="website">
    <meta property="og:title" content="ç½‘é¡µåµŒå…¥å™¨">
    <meta property="og:description" content="é€šè¿‡è¯†åˆ«ç å¿«é€ŸåµŒå…¥ä»»ä½•ç½‘é¡µ">
    <meta property="og:image" content="">
    
    <link rel="shortcut icon" href="" type="image/x-icon">
    <style>
        *{margin:0;padding:0;border:0}
        body,html{min-height:100%;background:#f8f8f8;font-family:Arial,sans-serif}
        body{overflow:hidden}
        iframe{width:100%;height:100vh;border:none}
        .error-content{color:red;font-size:18px;text-align:center;padding:50px;background:#fff;margin:20px;border-radius:10px}
        .loading{text-align:center;padding:50px;color:#666;background:#fff;margin:20px;border-radius:10px}
        .loading-spinner{display:inline-block;width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px}
        @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
        .loading-text{font-size:18px;color:#666;margin-top:20px}
    </style>
</head>
<body>
    <div id="content">
        <div class="loading">
            <div class="loading-spinner"></div>
            <div class="loading-text">æ­£åœ¨åŠ è½½ç½‘é¡µ...</div>
        </div>
    </div>
    
    <script>
        // APIé…ç½® - ä½¿ç”¨æœ¬åœ°HTTPSä»£ç†è§£å†³æ··åˆå†…å®¹é—®é¢˜
        const API_BASE_URL = 'https://tianyu365.github.io/wxffff/proxy.html';
        
        // è·å–URLå‚æ•°
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }
        
        // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
        function showLoading() {
            document.getElementById('content').innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">æ­£åœ¨åŠ è½½ç½‘é¡µ...</div>
                </div>
            `;
        }
        
        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            document.getElementById('content').innerHTML = `
                <div class="error-content">
                    <h3>âŒ åŠ è½½å¤±è´¥</h3>
                    <p>${message}</p>
                    <button onclick="location.reload()" style="margin-top:20px;padding:10px 20px;background:#007cba;color:white;border:none;border-radius:5px;cursor:pointer;">é‡è¯•</button>
                </div>
            `;
        }
        
        // æ˜¾ç¤ºåµŒå…¥ç½‘é¡µ
        function showEmbeddedPage(url) {
            const iframe = document.createElement('iframe');
            iframe.src = url;
            iframe.style.width = '100%';
            iframe.style.height = '100vh';
            iframe.style.border = 'none';
            
            // æ›¿æ¢åŠ è½½å†…å®¹
            document.getElementById('content').innerHTML = '';
            document.getElementById('content').appendChild(iframe);
            
            // å¤„ç†åŠ è½½é”™è¯¯
            iframe.onerror = function() {
                showError('ç½‘é¡µåŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç›®æ ‡ç½‘ç«™æ˜¯å¦å¯è®¿é—®');
            };
        }
        
        // ä»APIè·å–åµŒå…¥ä¿¡æ¯
        async function fetchEmbedInfo(embedId) {
            try {
                const response = await fetch(`${API_BASE_URL}?action=get_embed&id=${embedId}`);
                const data = await response.json();
                
                if (data.success) {
                    return data.data.target_url;
                } else {
                    throw new Error(data.error || 'è·å–åµŒå…¥ä¿¡æ¯å¤±è´¥');
                }
            } catch (error) {
                throw new Error('ç½‘ç»œè¯·æ±‚å¤±è´¥: ' + error.message);
            }
        }
        
        // ä¸»å‡½æ•°
        async function init() {
            const embedId = getUrlParameter('i');
            
            if (embedId) {
                try {
                    // æ˜¾ç¤º3ç§’åŠ è½½åŠ¨ç”»
                    showLoading();
                    
                    // ç­‰å¾…3ç§’
                    await new Promise(resolve => setTimeout(resolve, 3000));
                    
                    // ä»APIè·å–ç›®æ ‡URL
                    const targetUrl = await fetchEmbedInfo(embedId);
                    
                    // æ˜¾ç¤ºåµŒå…¥çš„ç½‘é¡µ
                    showEmbeddedPage(targetUrl);
                    
                } catch (error) {
                    showError(error.message);
                }
            } else {
                // æ²¡æœ‰å‚æ•°æ—¶æ˜¾ç¤ºä½¿ç”¨è¯´æ˜
                document.getElementById('content').innerHTML = `
                    <div style="text-align:center;padding:50px;background:#fff;margin:20px;border-radius:10px;">
                        <h2>ğŸŒ ç½‘é¡µåµŒå…¥å™¨</h2>
                        <p>ä½¿ç”¨æ–¹æ³•ï¼šåœ¨URLåæ·»åŠ  ?i=è¯†åˆ«ç </p>
                        <p>ä¾‹å¦‚ï¼š${window.location.href}?i=abc12345</p>
                        <p>è¿™æ ·å°±ä¼šåµŒå…¥å¯¹åº”çš„ç½‘é¡µ</p>
                        <br>
                        <p style="color:#666;font-size:14px;">
                            è¯·å…ˆåœ¨ç®¡ç†åå°åˆ›å»ºåµŒå…¥è®°å½•ï¼Œè·å–è¯†åˆ«ç åä½¿ç”¨
                        </p>
                    </div>
                `;
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
