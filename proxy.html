<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>API代理</title>
</head>
<body>
    <script>
        // 使用CORS代理服务
        async function proxyRequest() {
            const urlParams = new URLSearchParams(window.location.search);
            const action = urlParams.get('action');
            const id = urlParams.get('id');
            
            if (!action) {
                document.body.innerHTML = '<pre>{"success":false,"error":"缺少action参数"}</pre>';
                return;
            }
            
            // 构建目标URL
            let targetUrl = 'http://49.232.99.139:7777/admin/api.php?action=' + action;
            if (id) {
                targetUrl += '&id=' + id;
            }
            
            try {
                // 使用CORS代理服务
                const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(targetUrl);
                
                const response = await fetch(proxyUrl);
                const data = await response.text();
                
                // 尝试解析JSON
                try {
                    const jsonData = JSON.parse(data);
                    document.body.innerHTML = '<pre>' + JSON.stringify(jsonData, null, 2) + '</pre>';
                } catch (e) {
                    // 如果不是JSON，直接显示
                    document.body.innerHTML = '<pre>' + data + '</pre>';
                }
                
            } catch (error) {
                document.body.innerHTML = '<pre>{"success":false,"error":"' + error.message + '"}</pre>';
            }
        }
        
        // 页面加载时执行
        proxyRequest();
    </script>
</body>
</html>
